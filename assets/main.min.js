function s(){if(location.href.match(/\/orarend/g)){window.mh=0,$(".collection-item").css("height","unset");for(let t=$("ul"),e=0;t.length;t=$("ul.collection li:nth-child("+ ++e+")")){if(0==e)continue;let n=0;t.each(t=>{n=Math.max($(t).height(),n)}),t.css("height",n+"px")}}}$(window).on("resize",s),location.href.match(/^(?=.*\/login)(?!.*(toldy|sch)).*/g)&&(xhr=new XMLHttpRequest,xhr.open("GET","datas.json"),xhr.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),xhr.onload=function(){if(200===xhr.status&&xhr.responseText){var t=JSON.parse(xhr.responseText);let e=$("#sc"),n=e[0].list?$("#slc"):$("#rslc"),o=n.find("option:checked");o.length&&(o=o.val()),n.html(""),$(t).each(function(){n.append('<option value="'+this.v+'"'+(o==this.v?(o="","selected"):"")+">"+this.n+"</option>")}),e.on("blur",function(){if(!this.value)return;$("option[value="+this.value+"]").length?(this.setCustomValidity(""),M.validate_field($("#sc"))):this.setCustomValidity("Adjon meg egy érvényes értéket")})}},xhr.send());const average=(t,e=t.length)=>t.reduce((t,e)=>t+e)/e;function init(){let t=$(location.hash);t.length&&requestAnimationFrame(()=>{t[0].scrollIntoView()});let e=location.href;if(e.match(/\/orarend/g)){s();var n=$("#modal"),o=Modal(n);$(".lesson").on("click",function(t){$("#modal span").html("-");let e=$(this),a=e.find("b");n.find(".modal-content>span").html(a.is(".em")?"Elmarad!":"");let l=e.find("i");$(["lecke","time","theme"]).each(function(t){let e=l.attr(`data-${t}`);e&&n.find(`[data-${t}]`).html(e)}),n.find("[data-nth]").html(e.parent().attr("data-nth")),n.find("[data-tr]").html(a.html()),n.find("[data-teacher]").html(l.html()),n.find("[data-room]").html(e.find(".secondary-content").html()),o.open()})}if(e.match(/\/faliujsag/g)&&$(".s12:not(.m6) .collection-item").on("click",function(t){$(t.target).is("a")||$(this).find(".secondary-content")[0].click()}),e.match(/\/lecke/g)){s();n=$("#modal"),o=Modal(n);var a=Modal($("#addModal"));$(".collection-item").on("click",function(t){$("#modal span").html("-");let e=$(this);$(["lecke","sender","cdate"]).each(function(t){let o=e.attr(`data-${t}`);o&&n.find(`[data-${t}]`).html(o)}),n.find("[data-deadline]").html(e.find("a").html()),n.find("[data-tr]").html(e[0].innerHTML.split("<")[0]);let a=n.find("a").hide();e.hasAttr("data-del")&&a.show().attr("href","./lecke/torles?did="+e.attr("data-del")),o.open()}),(new DatePicker).renderCalendar(),$(".fab").on("click",function(){a.open()})}if(Collapsible($(".collapsible")),e.match(/\/hianyzasok/g)){s();n=$("#modal"),o=Modal(n);$("li p").on("click",function(t){$("#modal span").html("-");let e=$(this),a=e.parent().prev();$(["ct","jst","t","s"]).each(function(t){let o=e.attr(`data-${t}`);o&&n.find(`[data-${t}]`).html(o)}),n.find("[data-d]").html(a.find("span").html()),n.find("[data-ty]").html(a.attr("data-ty")),o.open()})}if(e.match(/\/jegyek/g)){t.closest("ntr").addClass("open");let e=Modal($("#addModal"));$(".fab").on("click",e.open);let n=$("#tr"),o=$("#nn");$("#cnn").on("click",function(){if(o.is(".valid")){let t=$(`[data-v="${n.val()}"]`).parent().find("ntd:not(:empty)"),a=$(t.slice(-3,-2)),l=$(t.slice(-1)),i=o.val(),d=$("#tz")[0].checked,c=d?"b":"span",s=d?2:1;$(t[t.length-4])[0].innerHTML+=` <${c} tooltip='Milenna ha-val hozzáadott jegy&#xa;Súly: ${s}00%'>${i}</${c}> `;let r=t.find("b, span").length,h=a.html(),p=[h*r,s*Number(i)],m=n[0].selectedOptions[0],f=Math.round(100*average(p,r+s))/100;a.html(f),m.innerHTML=m.innerHTML.replace(h,f);let u=Math.round(100*(f-$(t.slice(-2,-1)).html()))/100;l.html(u).removeClass("gr red").addClass(u<0?"red":"gr"),e.close()}else o[0].focus()})}$("[tooltip]").on("mouseenter",function(){$(this).toggleClass("bot",$(this).offset().top-window.scrollY-window.getComputedStyle(this,":after").getPropertyValue("height").replace("px","")-20<=0)}),$("a[href*=logout]").on("click",function(){deleteCookie("naplo"),deleteCookie("rme")})}function addCookie(t,e=1){var n=new Date;n.setDate(n.getDate()+365),document.cookie=`${t}=${e};expires=${n.toUTCString()};path=/`}function deleteCookie(t){document.cookie=`${t}=;expires=Thu, 01 Jan 1970 00:00:00 UTC;path=/`}$(()=>{ic.on(init),ic.init("mousedown")});let g=$("#gdpr");g.length&&Modal(g,{opacity:0,dismissible:!1,preventScrolling:!1,onCloseEnd:function(){addCookie("gdpr")}}).open(),"serviceWorker"in navigator&&navigator.serviceWorker.register("./sw.js",{scope:"/"}).then(function(t){return console.log("Service Worker Registered"),t.sync.register("bg")});let p=$("#pwa");if(p.length){let t;window.addEventListener("beforeinstallprompt",e=>{e.preventDefault(),t=e,Modal(p,{opacity:0,preventScrolling:!1}).open(),$("#pwa-btn").on("click",()=>{t.prompt(),t.userChoice.then(e=>{"accepted"===e.outcome?(addCookie("pwa",1),console.log("User accepted the A2HS prompt")):(addCookie("pwa",0),console.log("User dismissed the A2HS prompt")),t=null})})})}function os(){let t=$("#txt")[0],e=t.innerText;return e?($("#hw").val(e),!0):(t.focus(),!1)}