function Modal(t,e){let o={open:function(){if(o.isOpen)return;o.isOpen=!0,Modal._modalsOpen++,o._nthModalOpened=Modal._modalsOpen;let t=1e3+2*Modal._modalsOpen;if(o.$overlay.css({zIndex:t}),o.$el.css({zIndex:t+1}),o.options.preventScrolling&&$("body").addClass("no-scroll"),o.$overlay.show().css({opacity:o.options.opacity}),o.el.insertAdjacentElement("afterend",o.$overlay[0]),o.$el.addClass("open"),o.options.dismissible){var e=$(document);e.on("keydown",function(t){27===t.keyCode&&o.options.dismissible&&o.close()}),e.on("focus",function(t){o.el.contains(t.target)||o._nthModalOpened!==Modal._modalsOpen||o.el.focus()})}o.el.focus()},close:function(){if(o.isOpen){if(o.isOpen=!1,Modal._modalsOpen--,o._nthModalOpened=0,o.$overlay.css({opacity:0}),o.$el.removeClass("open"),$("body").removeClass("no-scroll"),o.options.dismissible){var t=$(document);t.off("keydown",o._handleKeydownBound),t.off("focus",o._handleFocusBound,!0)}setTimeout(function(){o.$overlay.remove(),o.options.onCloseEnd&&o.options.onCloseEnd()},250)}}};return o.el=t.is()?t[0]:t,o.$el=$(t),o.options=$.fn.extend({opacity:.5,onCloseEnd:null,preventScrolling:!0,dismissible:!0},e),o.isOpen=!1,o.$overlay=$(`<div ${0==o.options.opacity?"":'class="overlay"'}></div>`),o._nthModalOpened=0,Modal._count++,o.$overlay.on("click",function(){o.options.dismissible&&o.close()}),o.$el.on("click",function(t){$(t.target).closest(".modal-close").is()&&o.close()}),o}Modal._modalsOpen=0,$(window).on("click","nr nd:first-child",function(t){$(this).closest("nr").toggleClass("open")});var $currentLocationWithoutHash,$urlToPreload,$preloadTimer,$lastTouchTimestamp,$xhr,$ua=navigator.userAgent,$hasTouch="createTouch"in document,$history={},$url=!1,$title=!1,$mustRedirect=!1,$body=!1,$timing={},$isPreloading=!1,$isWaitingForCompletion=!1;function removeHash(t){return t.split("#")[0]}function getLinkTarget(t){let e=$(t).closest("a");return e.is()?e:$(t)}function isPreloadable(t){let e=t[0];var o=location.protocol+"//"+location.host;return!(!t.is("a")||e.target||t.hasAttr("download")||0!=e.href.indexOf(o+"/")||removeHash(e.href)==$currentLocationWithoutHash||$(t).closest("[data-no-instant]").is())}function triggerChange(){init()}function changePage(t,e,o){document.documentElement.replaceChild(e,document.body),$currentLocationWithoutHash=removeHash(o),url=o.split("#"),history.pushState(null,null,url[0]),document.title=t+String.fromCharCode(160),location.hash=url[1]?`#${url[1]}`:"",instantanize(),bar.done(),triggerChange()}function mousedown(t){if(!($lastTouchTimestamp>+new Date-500)){var e=getLinkTarget(t.target);e.is()&&isPreloadable(e)&&preload(e[0].href)}}function click(t){var e=getLinkTarget(t.target);e.is()&&isPreloadable(e)&&(t.which>1||t.metaKey||t.ctrlKey||(t.preventDefault(),display(e[0].href)))}function instantanize(){let t=$("body");var e=$("#menu");if(e.is()){let u=!1,p=!1;var o={x:0,y:0},n={x:0,y:0},i=!1;let f=0,m=!1;var a=!1,s=!1;let g=70,v=307;var l=e.next();function r(t){e.css({transform:`translateX(${t})`})}function c(){l.show().css({opacity:""}),t.addClass("no-scroll"),r(0),e.addClass("open"),s=!0}function d(){l.hide(),t.removeClass("no-scroll"),r("-110%"),e.removeClass("open"),s=!1}function h(){p||($("#rle").css({top:""}),$("body").removeClass("spin"))}$(document).on("scroll",function(){m||(i=!0)}),$(".overlay").on("click",d),$("#mo").on("click",()=>{c()}),t.on("touchstart",function(t){m=!1,a=!1,o.x=t.touches[0].pageX,o.y=t.touches[0].pageY,$lastTouchTimestamp=+new Date;var e=getLinkTarget(t.target);e.is()&&isPreloadable(e)&&(e.off("mousedown",mousedown),preload(e[0].href))}).on("touchmove",function(e){if(l.hide(),(a||s)&&l.show(),!i&&void 0!==e.touches){var n=e.touches[0].clientX-o.x,c=f=n;if((Math.abs(c)<v||o.x<50)&&Math.abs(n)>20&&(a=!0,!s&&n>0||s&&n<0)){n<=0&&(c=n+v,a=!1);let t=c-v;l.css({opacity:(280+t)/280*.2}),r(Math.min(t,0)+"px"),m=!0}if(u=0===document.scrollingElement.scrollTop&&!(s||a),t.toggleClass("no-scroll",u),u&&!p){const t=e.touches[0].pageY-o.y;$("#rle").css({top:Math.min(t,120)+"px"})}else h()}}).on("touchcancel",function(){m=!1,a=!1,i=!1}).on("touchend",function(t){if(m&&(a&&Math.abs(f)>g?c():d()),m=!1,n.x=t.changedTouches[0].pageX,n.y=t.changedTouches[0].pageY,u){var e=Math.abs(o.y-n.y),s=Math.abs(o.x-n.x);!p&&o.y<n.y&&(s<=100&&e>=90||s/e<=.3&&e>=60)?(h(),$("body").addClass("spin"),p=!0,display(addParam(location.href,"fr"))):h(),u=!1}i=!1})}t.on("mousedown",mousedown),t.on("click",click)}function preload(t){$preloadTimer&&(clearTimeout($preloadTimer),$preloadTimer=!1),t||(t=$urlToPreload),$isPreloading&&(t==$url||$isWaitingForCompletion)||($isPreloading=!0,$isWaitingForCompletion=!1,$url=t,$body=!1,$mustRedirect=!1,$timing={start:Date.now()},t=addParam(t,"just_html"),$xhr.open("GET",t),$xhr.send())}function display(t){if("display"in $timing||($timing.display=Date.now()-$timing.start),$preloadTimer||!$isPreloading)return $preloadTimer&&$url&&$url!=t?void(location.href=t):(preload(t),bar.start(0,!0),void($isWaitingForCompletion=!0));if($isWaitingForCompletion)location.href=t;else if($mustRedirect)location.href=$url;else{if(!$body)return bar.start(0,!0),void($isWaitingForCompletion=!0);$history[$currentLocationWithoutHash].scrollY=pageYOffset,$isPreloading=!1,$isWaitingForCompletion=!1,changePage($title,$body,$url)}}var bar=function(){var t,e,o,n;function i(e,i){o=e,t.css({opacity:1}),s(),i&&requestAnimationFrame(function(){o=10,s()}),clearTimeout(n),n=setTimeout(a,500)}function a(){o<98&&(o+=1+2*Math.random(),n=setTimeout(a,500)),s()}function s(){e.css({transform:"translate("+o+"%)"}),!$("#ic").is()&&document.body&&$("body").append(t)}function l(){t.css({left:pageXOffset+"px",width:innerWidth+"px",top:pageYOffset+"px"});var e="orientation"in window&&90==Math.abs(orientation),o=innerWidth/screen[e?"height":"width"]*2;t.css("transform","scaleY("+o+")")}return{init:function(){t=$('<div id="ic"></div>'),$("body").append(t),e=$('<div id="ic-bar" class="ic-bar"></div>'),t.append(e);var o=prefix+"transition",n=$("<style/>");n.html("#ic{position:"+($hasTouch?"absolute":"fixed")+";top:0;left:0;width:100%;pointer-events:none;z-index:9999;"+o+":all .25s .1s}.ic-bar{background:red;width:100%;margin-left:-100%;height:2px;"+o+":all .25s}"),$("head").append(n),$hasTouch&&(l(),addEventListener("resize",l),addEventListener("scroll",l))},start:i,done:function e(){if($("#ic").is())return clearTimeout(n),o=100,s(),void t.css({opacity:0});i(100==o?0:o),requestAnimationFrame(e)}}}(),supported="pushState"in history&&(!$ua.match("Android")||$ua.match("Chrome/"));function s(){if(/\/orarend/.test(location.href)){window.mh=0,$(".collection-item").css("height","unset");for(let t=$("ul"),e=0;t.is();t=$("ul.collection li:nth-child("+ ++e+")")){if(0==e)continue;let o=0;t.each(t=>{o=Math.max($(t).height(),o)}),t.css("height",o+"px")}$("#tt")[0].scrollTo(window.innerWidth*$("b.active").index(),0)}}$currentLocationWithoutHash||(supported?($preloadOnMousedown=!0,$currentLocationWithoutHash=removeHash(location.href),$history[$currentLocationWithoutHash]={body:document.body,title:document.title,scrollY:pageYOffset},($xhr=new XMLHttpRequest).addEventListener("readystatechange",function(){if(!($xhr.readyState<4||0==$xhr.status)){$timing.ready=Date.now()-$timing.start;var t=document.implementation.createHTMLDocument("");t.documentElement.innerHTML=$xhr.responseText.replace(/<noscript[\s\S]+<\/noscript>/gi,""),$title=t.title,$body=t.body;var e=removeHash($url);$history[e]={body:$body,title:$title,scrollY:e in $history?$history[e].scrollY:0},$isWaitingForCompletion&&($isWaitingForCompletion=!1,display($url))}}),instantanize(!0),bar.init(),triggerChange(),addEventListener("popstate",function(){var t=removeHash(location.href);t!=$currentLocationWithoutHash&&(t in $history?($history[$currentLocationWithoutHash].scrollY=pageYOffset,$currentLocationWithoutHash=t,changePage($history[t].title,$history[t].body,t,$history[t].scrollY)):location.href=location.href)})):triggerChange()),$(window).on("resize",s);const szazasra=t=>Math.round(100*t)/100;function calcAvr(t){let e=[],o=0;t.find("b,span").each(t=>{let n=(t=$(t)).is("b")?1:t.attr("tooltip").indexOf("100%")<0?.25:.5,i=t.html();i.indexOf("/")<0?e.push(n*i):e.push(...i.split("/").map(t=>t*(n/2))),o+=n});let n=szazasra(e.reduce((t,e)=>Number(t)+Number(e))/o),i=t.find("nd"),a=szazasra(n-i.eq(-2).html());i.eq(-1).html(a).removeClass("red gr").addClass(a<0?"red":"gr"),i.eq(-3).html(n);let s=$(`[value="${i.eq(0).attr("data-v")}"]`);s.html([s.html().split(" - ").shift(),n].join(" - "))}function init(){let t=$(location.hash);t.is()&&(toView(t[0]),$(t).find(".collapsible-body").addClass("open"));let e=location.href;if(/\/orarend/.test(e)){s();var o=Modal(a=$("#modal"));$(".lesson").on("click",function(){$("#modal span").html("-");let t=$(this),e=t.find("b");a.find(".modal-content>span").html(e.is(".em")?"Elmarad!":"");let n=t.find("i");$(["lecke","time","theme"]).each(function(t){let e=n.attr(`data-${t}`);e&&a.find(`[data-${t}]`).html(e)}),a.find("[data-nth]").html(t.parent().attr("data-nth")),a.find("[data-tr]").html(e.html()),a.find("[data-teacher]").html(n.html()),a.find("[data-room]").html(t.find(".secondary-content").html()),o.open()}),$(".btns b").on("click",function(){let t=$(this);$("#tt")[0].scrollTo(window.innerWidth*t.addClass("active").index(),0),t.siblings().removeClass("active")});let e=null;$("#tt").on("scroll",()=>{clearTimeout(e),e=setTimeout(function(){$(".btns b").removeClass("active").eq(Math.round($("#tt")[0].scrollLeft/window.innerWidth)).addClass("active")},25)}),$("#printBtn").on("click",function(){window.print()}),t.is(".lesson")&&t[0].click()}if(/\/faliujsag/.test(e)&&$("#fj li").on("click",function(t){$(t.target).is("a")||$(this).find(".secondary-content")[0].click()}),/\/lecke/.test(e)){if(!/Mobi|Android/i.test(navigator.userAgent))if("DatePicker"in window)new DatePicker;else{var n=document.createElement("script");n.type="text/javascript",n.src="assets/picker.js",n.onload=function(){new DatePicker},$("body").append(n)}$("[name=t]").on("change",function(){"date"==this.value?($("#hi").show(),$("#date").attr("required",!0)):($("#hi").hide(),$("#date")[0].removeAttribute("required"))});o=Modal(a=$("#modal"));var i=Modal($("#addModal"));$(".collection-item").on("click",function(t){$("#modal span").html("-");let e=$(this);$(["lecke","sender","cdate"]).each(function(t){let o=e.attr(`data-${t}`);o&&a.find(`[data-${t}]`).html(o)}),a.find("[data-deadline]").html(e.find("a").html()),a.find("[data-tr]").html(e[0].innerHTML.split("<")[0]);let n=a.find("a").hide();e.hasAttr("data-del")&&n.show().attr("href","./lecke/torles?did="+e.attr("data-del")),o.open()}),$(".fab").on("click",function(){i.open()}),$("form").on("submit",function(){let t=$("#txt")[0],e=t.innerText.trim();return e?($("#hw").val(e),!0):(t.focus(),!1)})}if($(".collapsible .collapsible-header").on("click",function(t){$(this).next().toggleClass("open")}),/\/hianyzasok/.test(e)){var a;o=Modal(a=$("#modal"));$("li p").on("click",function(t){$("#modal span").html("-");let e=$(this),n=e.parent().prev();$(["ct","jst","t","s"]).each(function(t){let o=e.attr(`data-${t}`);o&&a.find(`[data-${t}]`).html(o)}),a.find("[data-d]").html(n.find("span").html()),a.find("[data-ty]").html(n.attr("data-ty")),a.find("a").eq(-1)[0].href="orarend?week=-"+e.attr("data-l"),o.open()})}if(/\/jegyek/.test(e)){t.closest("nr").addClass("open");let e=Modal($("#addModal"));$(".fab").on("click",e.open);let o=$("#tr");$("#cnn").on("click",function(){let t=$("p>:checked").val();if(null!==t){let n=$(`[data-v="${o.val()}"]`).parent(),i=$("#tz")[0].checked,a=i?"b":"span",s=n.find("nd:not(:empty)").eq(-4),l=s[0];l.innerHTML+=` <${a} tooltip='Milenne ha-val hozzáadott jegy&#xa;Súly: ${i?2:1}00%' class='milenne'>${t}</${a}> `,calcAvr(n),e.close(),s.parent().addClass("open"),toView(l)}})}$(window).on("mousemove","[tooltip]",function(){$(this).toggleClass("bot",$(this).offset().top-window.scrollY-window.getComputedStyle(this,":after").getPropertyValue("height").replace("px","")-76<=0)}),$(window).on("dblclick",".milenne",function(){let t=$(this),e=t.closest("nr");t.remove(),calcAvr(e)}),$("a[href*=logout]").on("click",function(){deleteCookie("naplo"),deleteCookie("rme")})}function addCookie(t,e=1){var o=new Date;o.setDate(o.getDate()+365),document.cookie=`${t}=${e};expires=${o.toUTCString()};path=/`}function deleteCookie(t){document.cookie=`${t}=;expires=Thu, 01 Jan 1970 00:00:00 UTC;path=/`}$(()=>{let t=$("#gdpr");if(t.is()&&Modal(t,{opacity:0,dismissible:!1,preventScrolling:!1,onCloseEnd:function(){addCookie("gdpr")}}).open(),$(".pwa").is()){let t;addEventListener("beforeinstallprompt",e=>{e.preventDefault(),t=e,$(".pwa").show().on("click",()=>{t.prompt(),t.userChoice.then(e=>{"accepted"===e.outcome?(addCookie("pwa",1),console.log("User accepted the A2HS prompt")):(addCookie("pwa",0),console.log("User dismissed the A2HS prompt")),t=null})})})}}),addEventListener("appinstalled",()=>{addCookie("pwa")}),"serviceWorker"in navigator&&navigator.serviceWorker.register("./sw.js",{scope:"/"}).then(function(t){console.log("Service Worker Registered"),location.href.indexOf("login")<0&&t.sync.register("bg")});