function Modal(e,t){let o={open:function(){if(o.isOpen)return;o.isOpen=!0,Modal._modalsOpen++,o._nthModalOpened=Modal._modalsOpen;let e=1e3+2*Modal._modalsOpen;if(o.$overlay.css({zIndex:e}),o.$el.css({zIndex:e+1}),o.options.preventScrolling&&$("body").addClass("no-scroll"),o.$overlay.show().css({opacity:o.options.opacity}),o.el.insertAdjacentElement("afterend",o.$overlay[0]),o.$el.addClass("open"),o.options.dismissible){var t=$(document);t.on("keydown",function(e){27===e.keyCode&&o.options.dismissible&&o.close()}),t.on("focus",function(e){o.el.contains(e.target)||o._nthModalOpened!==Modal._modalsOpen||o.el.focus()})}o.el.focus()},close:function(){if(o.isOpen){if(o.isOpen=!1,Modal._modalsOpen--,o._nthModalOpened=0,o.$overlay.css({opacity:0}),o.$el.removeClass("open"),$("body").removeClass("no-scroll"),o.options.dismissible){var e=$(document);e.off("keydown",o._handleKeydownBound),e.off("focus",o._handleFocusBound,!0)}setTimeout(function(){o.$overlay.remove(),o.options.onCloseEnd&&o.options.onCloseEnd()},250)}}};return o.el=e.is()?e[0]:e,o.$el=$(e),o.options=$.fn.extend({opacity:.5,onCloseEnd:null,preventScrolling:!0,dismissible:!0},t),o.isOpen=!1,o.$overlay=$(`<div ${0==o.options.opacity?"":'class="overlay"'}></div>`),o._nthModalOpened=0,Modal._count++,o.$overlay.on("click",function(){o.options.dismissible&&o.close()}),o.$el.on("click",function(e){$(e.target).closest(".modal-close").is()&&o.close()}),o}Modal._modalsOpen=0,$(window).on("click","nr nd:first-child",function(e){$(this).closest("nr").toggleClass("open")});var $currentLocationWithoutHash,$urlToPreload,$preloadTimer,$lastTouchTimestamp,$xhr,$ua=navigator.userAgent,$hasTouch="createTouch"in document,$history={},$url=!1,$title=!1,$mustRedirect=!1,$body=!1,$timing={},$isPreloading=!1,$isWaitingForCompletion=!1;function removeHash(e){return e.split("#")[0]}function getLinkTarget(e){let t=$(e).closest("a");return t.is()?t:$(e)}function isPreloadable(e){let t=e[0];var o=location.protocol+"//"+location.host;return!(!e.is("a")||t.target||e.hasAttr("download")||0!=t.href.indexOf(o+"/")||removeHash(t.href)==$currentLocationWithoutHash||$(e).closest("[data-no-instant]").is())}function triggerChange(){init()}function changePage(e,t,o){document.documentElement.replaceChild(t,document.body),$currentLocationWithoutHash=removeHash(o),url=o.split("#"),history.pushState(null,null,url[0]),document.title=e+String.fromCharCode(160),location.hash=url[1]?`#${url[1]}`:"",instantanize(),bar.done(),triggerChange()}function mousedown(e){if(!($lastTouchTimestamp>+new Date-500)){var t=getLinkTarget(e.target);t.is()&&isPreloadable(t)&&preload(t[0].href)}}function click(e){var t=getLinkTarget(e.target);t.is()&&isPreloadable(t)&&(e.which>1||e.metaKey||e.ctrlKey||(e.preventDefault(),display(t[0].href)))}function scrollCb(){_opened&&_opening||(window.scrolling=!0)}function instantanize(){let e=$("body");var t=$("#menu");if(t.is()){let c=!1,d=!1;var o={x:0,y:0},n={x:0,y:0};window.scrolling=!1;let h=0,u=!1;window._opening=!1,window._opened=!1;let p=70,f=307;var i=t.next();function a(e){t.css({transform:`translateX(${e})`})}function l(){i.show().css({opacity:""}),e.addClass("no-scroll"),a(0),t.addClass("open"),_opened=!0}function s(){i.hide(),e.removeClass("no-scroll"),a("-110%"),t.removeClass("open"),_opened=!1}function r(){d||($("#rle").css({top:""}),$("body").removeClass("spin"))}$(window).on("scroll",scrollCb),$(".overlay").on("click",s),$("#mo").on("click",()=>{l()}),e.on("touchstart",function(e){if(1==e.touches.length){u=!1,_opening=!1,o.x=e.touches[0].pageX,o.y=e.touches[0].pageY,$lastTouchTimestamp=+new Date;var t=getLinkTarget(e.target);t.is()&&isPreloadable(t)&&(t.off("mousedown",mousedown),preload(t[0].href))}}).on("touchmove",function(t){if(i.hide(),(_opening||_opened)&&i.show(),!scrolling&&void 0!==t.touches&&!Modal._modalsOpen){var n=t.touches[0].clientX-o.x,l=h=n;if((Math.abs(l)<f||o.x<50)&&Math.abs(n)>20&&(_opening=!0,!_opened&&n>0||_opened&&n<0)){n<=0&&(l=n+f,_opening=!1);let e=l-f;i.css({opacity:(280+e)/280*.2}),a(Math.min(e,0)+"px"),u=!0}if(c=0===document.scrollingElement.scrollTop&&!(_opened||_opening),e.toggleClass("no-scroll",c),c&&!d){const e=t.touches[0].pageY-o.y;$("#rle").css({top:Math.min(e,120)+"px"})}else r()}}).on("touchcancel",function(){u=!1,_opening=!1,scrolling=!1}).on("touchend",function(e){if(u&&(_opening&&Math.abs(h)>p?l():s()),u=!1,n.x=e.changedTouches[0].pageX,n.y=e.changedTouches[0].pageY,c){var t=Math.abs(o.y-n.y),i=Math.abs(o.x-n.x);!d&&o.y<n.y&&(i<=100&&t>=90||i/t<=.3&&t>=60)?(r(),$("body").addClass("spin"),d=!0,display(addParam(location.href,"fr"))):r(),c=!1}scrolling=!1})}e.on("mousedown",mousedown),e.on("click",click)}function preload(e){$preloadTimer&&(clearTimeout($preloadTimer),$preloadTimer=!1),e||(e=$urlToPreload),$isPreloading&&(e==$url||$isWaitingForCompletion)||($isPreloading=!0,$isWaitingForCompletion=!1,$url=e,$body=!1,$mustRedirect=!1,$timing={start:Date.now()},e=addParam(e,"just_html"),$xhr.open("GET",e),$xhr.send())}function display(e){if("display"in $timing||($timing.display=Date.now()-$timing.start),$preloadTimer||!$isPreloading)return $preloadTimer&&$url&&$url!=e?void(location.href=e):(preload(e),bar.start(0,!0),void($isWaitingForCompletion=!0));if($isWaitingForCompletion)location.href=e;else if($mustRedirect)location.href=$url;else{if(!$body)return bar.start(0,!0),void($isWaitingForCompletion=!0);$history[$currentLocationWithoutHash].scrollY=pageYOffset,$isPreloading=!1,$isWaitingForCompletion=!1,changePage($title,$body,$url)}}var bar=function(){var e,t,o,n;function i(t,i){o=t,e.css({opacity:1}),l(),i&&requestAnimationFrame(function(){o=10,l()}),clearTimeout(n),n=setTimeout(a,500)}function a(){o<98&&(o+=1+2*Math.random(),n=setTimeout(a,500)),l()}function l(){t.css({transform:"translate("+o+"%)"}),!$("#ic").is()&&document.body&&$("body").append(e)}function s(){e.css({left:pageXOffset+"px",width:innerWidth+"px",top:pageYOffset+"px"});var t="orientation"in window&&90==Math.abs(orientation),o=innerWidth/screen[t?"height":"width"]*2;e.css("transform","scaleY("+o+")")}return{init:function(){e=$('<div id="ic"></div>'),$("body").append(e),t=$('<div id="ic-bar" class="ic-bar"></div>'),e.append(t);var o=prefix+"transition",n=$("<style/>");n.html("#ic{position:"+($hasTouch?"absolute":"fixed")+";top:0;left:0;width:100%;pointer-events:none;z-index:9999;"+o+":all .25s .1s}.ic-bar{background:red;width:100%;margin-left:-100%;height:2px;"+o+":all .25s}"),$("head").append(n),$hasTouch&&(s(),addEventListener("resize",s),addEventListener("scroll",s))},start:i,done:function t(){if($("#ic").is())return clearTimeout(n),o=100,l(),void e.css({opacity:0});i(100==o?0:o),requestAnimationFrame(t)}}}(),supported="pushState"in history&&(!$ua.match("Android")||$ua.match("Chrome/"));function s(){if(/\/orarend/.test(location.href)){window.mh=0,$(".collection-item").css("height","unset");for(let e=$("ul"),t=0;e.is();e=$("ul.collection li:nth-child("+ ++t+")")){if(0==t)continue;let o=0;e.each(e=>{o=Math.max($(e).height(),o)}),e.css("height",o+"px")}$("#tt")[0].scrollTo(window.innerWidth*$("b.active").index(),0)}}$currentLocationWithoutHash||(supported?($preloadOnMousedown=!0,$currentLocationWithoutHash=removeHash(location.href),$history[$currentLocationWithoutHash]={body:document.body,title:document.title,scrollY:pageYOffset},($xhr=new XMLHttpRequest).addEventListener("readystatechange",function(){if(!($xhr.readyState<4||0==$xhr.status)){$timing.ready=Date.now()-$timing.start;var e=document.implementation.createHTMLDocument("");e.documentElement.innerHTML=$xhr.responseText.replace(/<noscript[\s\S]+<\/noscript>/gi,""),$title=e.title,$body=e.body;var t=removeHash($url);$history[t]={body:$body,title:$title,scrollY:t in $history?$history[t].scrollY:0},$isWaitingForCompletion&&($isWaitingForCompletion=!1,display($url))}}),instantanize(!0),bar.init(),triggerChange(),addEventListener("popstate",function(){var e=removeHash(location.href);e!=$currentLocationWithoutHash&&(e in $history?($history[$currentLocationWithoutHash].scrollY=pageYOffset,$currentLocationWithoutHash=e,changePage($history[e].title,$history[e].body,e,$history[e].scrollY)):location.href=location.href)})):triggerChange()),$(window).on("resize",s);const szazasra=e=>Math.round(100*e)/100;function calcAvr(e){let t=[],o=0;e.find(".jegy").each(e=>{if((e=$(e)).is(".in"))return;let n=e.is("b")?1:e.attr("tooltip").indexOf("100%")<0?.25:.5,i=e.html();i.indexOf("/")<0?t.push(n*i):t.push(...i.split("/").map(e=>e*(n/2))),o+=n});let n=szazasra(t.reduce((e,t)=>Number(e)+Number(t))/o),i=e.find("nd"),a=szazasra(n-i.eq(-2).html());i.eq(-1).html(a).removeClass("red gr").addClass(a<0?"red":"gr"),i.eq(-3).html(n);let l=$(`[value="${i.eq(0).attr("data-v")}"]`);l.html([l.html().split(" - ").shift(),n].join(" - "))}function init(){let e=$(location.hash);e.is()&&(toView(e[0]),$(e).find(".collapsible-body").addClass("open"));let t=location.href;if(/\/orarend/.test(t)){s();let t=$(`[data-day="${(new Date).toISOString().split("T")[0]}"]`);t.is()&&(t.addClass("activeDay"),$("#tt")[0].scrollTo(t.index()*innerWidth,0));var o=Modal(a=$("#modal"));$(".lesson").on("click",function(){$("#modal span").html("-");let e=$(this),t=e.find("b");a.find(".modal-content>span").html(t.is(".em")?"Elmarad!":"");let n=e.find("i");$(["lecke","time","theme"]).each(function(e){let t=n.attr(`data-${e}`);t&&a.find(`[data-${e}]`).html(t)}),a.find("[data-nth]").html(e.parent().attr("data-nth")),a.find("[data-tr]").html(t.html()),a.find("[data-teacher]").html(n.html()),a.find("[data-room]").html(e.find(".secondary-content").html()),o.open()}),$(".btns b").on("click",function(){let e=$(this);$("#tt")[0].scrollTo(window.innerWidth*e.index(),0),e.siblings().removeClass("active")});let n=null;$("#tt").on("scroll",()=>{clearTimeout(n),n=setTimeout(function(){$(".btns b").removeClass("active").eq(Math.round($("#tt")[0].scrollLeft/window.innerWidth)).addClass("active")},250),scrollCb()}),$("#printBtn").on("click",function(){window.print()}),e.is(".lesson")&&e[0].click()}if(/\/faliujsag/.test(t)&&$("#fj li").on("click",function(e){$(e.target).is("a")||$(this).find(".secondary-content")[0].click()}),/\/lecke/.test(t)){if(!/Mobi|Android/i.test(navigator.userAgent))if("DatePicker"in window)new DatePicker;else{var n=document.createElement("script");n.type="text/javascript",n.src="assets/picker.js",n.onload=function(){new DatePicker},$("body").append(n)}$("[name=t]").on("change",function(){"date"==this.value?($("#hi").show(),$("#date").attr("required",!0)):($("#hi").hide(),$("#date")[0].removeAttribute("required"))});o=Modal(a=$("#modal"));var i=Modal($("#addModal"));$(".collection-item").on("click",function(e){$("#modal span").html("-");let t=$(this);$(["lecke","sender","cdate"]).each(function(e){let o=t.attr(`data-${e}`);o&&a.find(`[data-${e}]`).html(o)}),a.find("[data-deadline]").html(t.find("a").html()),a.find("[data-tr]").html(t[0].innerHTML.split("<")[0]);let n=a.find("a").hide();t.hasAttr("data-del")&&n.show().attr("href","./lecke/torles?did="+t.attr("data-del")),o.open()}),$(".fab").on("click",function(){i.open()}),$("form").on("submit",function(){let e=$("#txt")[0],t=e.innerText.trim();return t?($("#hw").val(t),!0):(e.focus(),!1)})}if($(".collapsible .collapsible-header").on("click",function(e){$(this).next().toggleClass("open")}),/\/hianyzasok/.test(t)){var a;o=Modal(a=$("#modal"));$("li p").on("click",function(e){$("#modal span").html("-");let t=$(this),n=t.parent().prev();$(["ct","jst","t","s"]).each(function(e){let o=t.attr(`data-${e}`);o&&a.find(`[data-${e}]`).html(o)}),a.find("[data-d]").html(n.find("span").html()),a.find("[data-ty]").html(n.attr("data-ty")),a.find("a").eq(-1)[0].href="orarend?week=-"+t.attr("data-l"),o.open()})}if(/\/jegyek/.test(t)){e.closest("nr").addClass("open");let t=Modal($("#addModal"));$(".fab").on("click",t.open);let o=$("#tr");$("#tort").on("change",function(){$(".j").hide().eq(this.checked?1:0).show(),$(".j").find("input").each(e=>{e.checked=!1})}),$("#cnn").on("click",function(){let e=$("p.j>:checked").val();if(null!==e){let n=$(`[data-v="${o.val()}"]`).parent(),i=$(".w>:checked").val(),a=200==i?"b":"span",l=n.find(".jegy").eq(-1).parent(),s=l[0];s.innerHTML+=` <${a} tooltip='Milenne ha-val hozzáadott jegy&#xa;Súly: ${i}%' class='milenne jegy'>${e}</${a}> `,calcAvr(n),t.close(),l.parent().addClass("open"),toView(s)}})}$(window).on("mousemove","[tooltip]",function(){$(this).toggleClass("bot",$(this).offset().top-window.scrollY-window.getComputedStyle(this,":after").getPropertyValue("height").replace("px","")-76<=0)}),$(window).on("dblclick",".milenne",function(){let e=$(this),t=e.closest("nr");e.remove(),calcAvr(t)}),$("a[href*=logout]").on("click",function(){deleteCookie("naplo"),deleteCookie("rme")})}function addCookie(e,t=1){var o=new Date;o.setDate(o.getDate()+365),document.cookie=`${e}=${t};expires=${o.toUTCString()};path=/`}function deleteCookie(e){document.cookie=`${e}=;expires=Thu, 01 Jan 1970 00:00:00 UTC;path=/`}$(()=>{let e=$("#gdpr");if(e.is()&&Modal(e,{opacity:0,dismissible:!1,preventScrolling:!1,onCloseEnd:function(){addCookie("gdpr")}}).open(),$(".pwa").is()){let e;addEventListener("beforeinstallprompt",t=>{t.preventDefault(),e=t,$(".pwa").show().on("click",()=>{e.prompt(),e.userChoice.then(t=>{"accepted"===t.outcome?(addCookie("pwa",1),console.log("User accepted the A2HS prompt")):(addCookie("pwa",0),console.log("User dismissed the A2HS prompt")),e=null})})})}}),addEventListener("appinstalled",()=>{addCookie("pwa")}),"serviceWorker"in navigator&&navigator.serviceWorker.register("./sw.js",{scope:"/"}).then(function(e){console.log("Service Worker Registered"),location.href.indexOf("login")<0&&e.sync.register("bg")});