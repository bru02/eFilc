function s(){if(location.href.match(/\/orarend/g)){window.mh=0,$(".collection-item").css("height","unset");for(let t=$("ul"),e=0;t.length;t=$("ul.collection li:nth-child("+ ++e+")")){if(0==e)continue;let n=0;t.each(t=>{n=Math.max($(t).height(),n)}),t.css("height",n+"px")}$("#tt")[0].scrollTo(window.innerWidth*$("b.active").index(),0)}}$(window).on("resize",s),location.href.match(/login/g)&&(xhr=new XMLHttpRequest,xhr.open("GET","datas.json"),xhr.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),xhr.onload=function(){if(200===xhr.status&&xhr.responseText){var t=JSON.parse(xhr.responseText);let e=$("#sc"),n=e[0].list?$("#slc"):$("#rslc"),o=n.find("option:checked");o.length&&(o=o.val()),n.html(""),$(t).each(function(){n.append('<option value="'+this.v+'"'+(o==this.v?(o="","selected"):"")+">"+this.n+"</option>")}),e.on("change",function(){if(!this.value)return;$("option[value="+this.value+"]").length?this.setCustomValidity(""):this.setCustomValidity("Adjon meg egy érvényes értéket"),M.validate_field($("#sc"))})}},xhr.send());const average=(t,e=t.length)=>t.reduce((t,e)=>t+e)/e;function init(){let t=$(location.hash);t.length&&requestAnimationFrame(()=>{t[0].scrollIntoView()});let e=location.href;if(e.match(/\/orarend/g)){s();var n=$("#modal"),o=Modal(n);$(".lesson").on("click",function(t){$("#modal span").html("-");let e=$(this),i=e.find("b");n.find(".modal-content>span").html(i.is(".em")?"Elmarad!":"");let a=e.find("i");$(["lecke","time","theme"]).each(function(t){let e=a.attr(`data-${t}`);e&&n.find(`[data-${t}]`).html(e)}),n.find("[data-nth]").html(e.parent().attr("data-nth")),n.find("[data-tr]").html(i.html()),n.find("[data-teacher]").html(a.html()),n.find("[data-room]").html(e.find(".secondary-content").html()),o.open()}),$(".btns b").on("click",function(){let t=$(this);$("#tt")[0].scrollTo(window.innerWidth*t.addClass("active").index(),0),t.siblings().removeClass("active")});let t=null;$("#tt").on("scroll",()=>{clearTimeout(t),t=setTimeout(function(){$(".btns b").removeClass("active").eq(Math.round($("#tt")[0].scrollLeft/window.innerWidth)).addClass("active")},200)})}if(e.match(/\/faliujsag/g)&&$(".s12:not(.m6) .collection-item").on("click",function(t){$(t.target).is("a")||$(this).find(".secondary-content")[0].click()}),e.match(/\/lecke/g)){s();n=$("#modal"),o=Modal(n);var i=Modal($("#addModal"));$(".collection-item").on("click",function(t){$("#modal span").html("-");let e=$(this);$(["lecke","sender","cdate"]).each(function(t){let o=e.attr(`data-${t}`);o&&n.find(`[data-${t}]`).html(o)}),n.find("[data-deadline]").html(e.find("a").html()),n.find("[data-tr]").html(e[0].innerHTML.split("<")[0]);let i=n.find("a").hide();e.hasAttr("data-del")&&i.show().attr("href","./lecke/torles?did="+e.attr("data-del")),o.open()}),(new DatePicker).renderCalendar(),$(".fab").on("click",function(){i.open()})}if(Collapsible($(".collapsible")),e.match(/\/hianyzasok/g)){s();n=$("#modal"),o=Modal(n);$("li p").on("click",function(t){$("#modal span").html("-");let e=$(this),i=e.parent().prev();$(["ct","jst","t","s"]).each(function(t){let o=e.attr(`data-${t}`);o&&n.find(`[data-${t}]`).html(o)}),n.find("[data-d]").html(i.find("span").html()),n.find("[data-ty]").html(i.attr("data-ty")),o.open()})}if(e.match(/\/jegyek/g)){t.closest("ntr").addClass("open");let e=Modal($("#addModal"));$(".fab").on("click",e.open);let n=$("#tr"),o=$("#nn");$("#cnn").on("click",function(){if(o.is(".valid")){let t=$(`[data-v="${n.val()}"]`).parent().find("ntd:not(:empty)"),i=$(t.slice(-3,-2)),a=$(t.slice(-1)),l=o.val(),d=$("#tz")[0].checked,s=d?"b":"span",c=d?2:1;$(t[t.length-4])[0].innerHTML+=` <${s} tooltip='Milenna ha-val hozzáadott jegy&#xa;Súly: ${c}00%'>${l}</${s}> `;let r=t.find("b, span").length,h=i.html(),m=[h*r,c*Number(l)],f=n[0].selectedOptions[0],p=Math.round(100*average(m,r+c))/100;i.html(p),f.innerHTML=f.innerHTML.replace(h,p);let u=Math.round(100*(p-$(t.slice(-2,-1)).html()))/100;a.html(u).removeClass("gr red").addClass(u<0?"red":"gr"),e.close()}else o[0].focus()})}$(window).on("mousemove","[tooltip]",function(){$(this).toggleClass("bot",$(this).offset().top-window.scrollY-window.getComputedStyle(this,":after").getPropertyValue("height").replace("px","")-76<=0)}),$("a[href*=logout]").on("click",function(){deleteCookie("naplo"),deleteCookie("rme")})}function addCookie(t,e=1){var n=new Date;n.setDate(n.getDate()+365),document.cookie=`${t}=${e};expires=${n.toUTCString()};path=/`}function deleteCookie(t){document.cookie=`${t}=;expires=Thu, 01 Jan 1970 00:00:00 UTC;path=/`}function os(){let t=$("#txt")[0],e=t.innerText;return e?($("#hw").val(e),!0):(t.focus(),!1)}"ic"in window&&$(()=>{ic.on(init),ic.init("mousedown");let t=$("#gdpr");if(t.length&&Modal(t,{opacity:0,dismissible:!1,preventScrolling:!1,onCloseEnd:function(){addCookie("gdpr")}}).open(),$(".pwa").length){let t;window.addEventListener("beforeinstallprompt",e=>{e.preventDefault(),t=e,$(".pwa").show().on("click",()=>{t.prompt(),t.userChoice.then(e=>{"accepted"===e.outcome?(addCookie("pwa",1),console.log("User accepted the A2HS prompt")):(addCookie("pwa",0),console.log("User dismissed the A2HS prompt")),t=null})})})}}),"serviceWorker"in navigator&&navigator.serviceWorker.register("./sw.js",{scope:"/"}).then(function(t){console.log("Service Worker Registered"),location.href.indexOf("login")<0&&t.sync.register("bg")});