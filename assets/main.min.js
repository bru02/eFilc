function s(){if(location.href.match(/\/orarend/g)){window.mh=0,$(".collection-item").css("height","unset");for(let e=$("ul"),t=0;e.length;e=$("ul.collection li:nth-child("+ ++t+")")){if(0==t)continue;let n=0;e.each(e=>{n=Math.max($(e).height(),n)}),e.css("height",n+"px")}}}$(window).on("resize",s),location.href.match(/^(?=.*\/login)(?!.*(toldy|sch)).*/g)&&(xhr=new XMLHttpRequest,xhr.open("GET","datas.json"),xhr.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),xhr.onload=function(){if(200===xhr.status&&xhr.responseText){var e=JSON.parse(xhr.responseText);let t=$("#sc"),n=t[0].list?$("#slc"):$("#rslc"),o=n.find("option:checked");o.length&&(o=o.val()),n.html(""),$(e).each(function(){n.append('<option value="'+this.v+'"'+(o==this.v?(o="","selected"):"")+">"+this.n+"</option>")}),t.on("blur",function(){if(!this.value)return;$("option[value="+this.value+"]").length?(this.setCustomValidity(""),M.validate_field($("#sc"))):this.setCustomValidity("Adjon meg egy érvényes értéket")})}},xhr.send());const average=(e,t=e.length)=>e.reduce((e,t)=>e+t)/t;function init(){let e=$(location.hash);e.length&&requestAnimationFrame(()=>{e[0].scrollIntoView()});let t=location.href;if(t.match(/\/orarend/g)){s();var n=$("#modal"),o=Modal(n);$(".lesson").on("click",function(e){$("#modal span").html("-");let t=$(this),i=t.find("b");n.find(".modal-content>span").html(i.is(".em")?"Elmarad!":"");let l=t.find("i");$(["lecke","time","theme"]).each(function(e){let t=l.attr(`data-${e}`);t&&n.find(`[data-${e}]`).html(t)}),n.find("[data-nth]").html(t.parent().attr("data-nth")),n.find("[data-tr]").html(i.html()),n.find("[data-teacher]").html(l.html()),n.find("[data-room]").html(t.find(".secondary-content").html()),o.open()})}if(t.match(/\/faliujsag/g)&&$(".s12:not(.m6) .collection-item").on("click",function(e){$(e.target).is("a")||$(this).find(".secondary-content")[0].click()}),t.match(/\/lecke/g)){s();n=$("#modal"),o=Modal(n);var i=Modal($("#addModal"));$(".collection-item").on("click",function(e){$("#modal span").html("-");let t=$(this);$(["lecke","sender","cdate"]).each(function(e){let o=t.attr(`data-${e}`);o&&n.find(`[data-${e}]`).html(o)}),n.find("[data-deadline]").html(t.find("a").html()),n.find("[data-tr]").html(t[0].innerHTML.split("<")[0]);let i=n.find("a").hide();t.hasAttr("data-del")&&i.show().attr("href","./lecke/torles?did="+t.attr("data-del")),o.open()}),(new DatePicker).renderCalendar(),$(".fab").on("click",function(){i.open()})}if(Collapsible($(".collapsible")),t.match(/\/jegyek/g)){e.closest("ntr").addClass("open");let t=Modal($("#addModal"));$(".fab").on("click",t.open);let n=$("#tr");$("#cnn").on("click",function(){let e=$(`[data-v="${n.val()}"]`).parent().find("ntd:not(:empty)"),t=$(e.slice(-3,-2)),o=$(e.slice(-1)),i=$("#nn").val(),l=$("#tz")[0].checked,a=l?"b":"span",d=l?2:1;$(e[e.length-4])[0].innerHTML+=` <${a} tooltip='Milenna ha-val hozzáadott jegy&#xa;Súly: ${d}00%'>${i}</${a}> `;let r=e.find("b, span").length,c=t.html(),s=[c*r,d*Number(i)],h=n[0].selectedOptions[0],p=Math.round(100*average(s,r+d))/100;t.html(p),h.innerHTML=h.innerHTML.replace(c,p);let m=Math.round(100*(p-$(e.slice(-2,-1)).html()))/100;o.html(m).removeClass("gr red").addClass(m<0?"red":"gr")})}$("[tooltip]").on("mouseenter",function(){$(this).toggleClass("bot",$(this).offset().top-window.scrollY-window.getComputedStyle(this,":after").getPropertyValue("height").replace("px","")-20<=0)}),$("a[href*=logout]").on("click",function(){deleteCookie("naplo"),deleteCookie("rme")})}function addCookie(e,t=1){var n=new Date;n.setDate(n.getDate()+365),document.cookie=`${e}=${t};expires=${n.toUTCString()};path=/`}function deleteCookie(e){document.cookie=`${e}=;expires=Thu, 01 Jan 1970 00:00:00 UTC;path=/`}$(()=>{ic.on(init),ic.init("mousedown")});let g=$("#gdpr");g.length&&Modal(g,{opacity:0,dismissible:!1,preventScrolling:!1,onCloseEnd:function(){addCookie("gdpr")}}).open(),"serviceWorker"in navigator&&navigator.serviceWorker.register("./sw.js",{scope:"/"}).then(function(e){return console.log("Service Worker Registered"),e.sync.register("bg")});let p=$("#pwa");if(p.length){let e;window.addEventListener("beforeinstallprompt",t=>{t.preventDefault(),e=t,Modal(p,{opacity:0,preventScrolling:!1}).open(),$("#pwa-btn").on("click",()=>{e.prompt(),e.userChoice.then(t=>{"accepted"===t.outcome?(addCookie("pwa",1),console.log("User accepted the A2HS prompt")):(addCookie("pwa",0),console.log("User dismissed the A2HS prompt")),e=null})})})}function os(){let e=$("#txt")[0].innerText;return!!e&&($("#hw").val(e),!0)}