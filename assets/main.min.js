function s(){if(location.href.match(/\/orarend/g)){window.mh=0,$(".collection-item").css("height","unset");for(let e=$("ul"),t=0;e.length;e=$("ul.collection li:nth-child("+ ++t+")")){if(0==t)continue;let n=0;e.each(e=>{n=Math.max($(e).height(),n)}),e.css("height",n+"px")}$("#tt")[0].scrollTo(window.innerWidth*$("b.active").index(),0)}}$(window).on("resize",s),location.href.match(/login/g)&&(xhr=new XMLHttpRequest,xhr.open("GET","datas.json"),xhr.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),xhr.onload=function(){if(200===xhr.status&&xhr.responseText){var e=JSON.parse(xhr.responseText);let t=$("#sc"),n=t[0].list?$("#slc"):$("#rslc"),o=n.find("option:checked");o.length&&(o=o.val()),n.html(""),$(e).each(function(){n.append('<option value="'+this.v+'"'+(o==this.v?(o="","selected"):"")+">"+this.n+"</option>")}),t.on("change",function(){if(!this.value)return;$("option[value="+this.value+"]").length?this.setCustomValidity(""):this.setCustomValidity("Adjon meg egy érvényes értéket"),M.validate_field($("#sc"))})}},xhr.send());const average=(e,t=e.length)=>e.reduce((e,t)=>e+t)/t;function init(){let e=$(location.hash);e.length&&requestAnimationFrame(()=>{e[0].scrollIntoView()});let t=location.href;if(t.match(/\/orarend/g)){s();var n=$("#modal"),o=Modal(n);$(".lesson").on("click",function(e){$("#modal span").html("-");let t=$(this),i=t.find("b");n.find(".modal-content>span").html(i.is(".em")?"Elmarad!":"");let a=t.find("i");$(["lecke","time","theme"]).each(function(e){let t=a.attr(`data-${e}`);t&&n.find(`[data-${e}]`).html(t)}),n.find("[data-nth]").html(t.parent().attr("data-nth")),n.find("[data-tr]").html(i.html()),n.find("[data-teacher]").html(a.html()),n.find("[data-room]").html(t.find(".secondary-content").html()),o.open()}),$(".btns b").on("click",function(){let e=$(this);$("#tt")[0].scrollTo(window.innerWidth*e.addClass("active").index(),0),e.siblings().removeClass("active")});let e=null;$("#tt").on("scroll",()=>{clearTimeout(e),e=setTimeout(function(){$(".btns b").removeClass("active").eq(Math.round($("#tt")[0].scrollLeft/window.innerWidth)).addClass("active")},200)})}if(t.match(/\/faliujsag/g)&&$(".s12:not(.m6) .collection-item").on("click",function(e){$(e.target).is("a")||$(this).find(".secondary-content")[0].click()}),t.match(/\/lecke/g)){s();n=$("#modal"),o=Modal(n);var i=Modal($("#addModal"));$(".collection-item").on("click",function(e){$("#modal span").html("-");let t=$(this);$(["lecke","sender","cdate"]).each(function(e){let o=t.attr(`data-${e}`);o&&n.find(`[data-${e}]`).html(o)}),n.find("[data-deadline]").html(t.find("a").html()),n.find("[data-tr]").html(t[0].innerHTML.split("<")[0]);let i=n.find("a").hide();t.hasAttr("data-del")&&i.show().attr("href","./lecke/torles?did="+t.attr("data-del")),o.open()}),(new DatePicker).renderCalendar(),$(".fab").on("click",function(){i.open()})}if(Collapsible($(".collapsible")),t.match(/\/hianyzasok/g)){s();n=$("#modal"),o=Modal(n);$("li p").on("click",function(e){$("#modal span").html("-");let t=$(this),i=t.parent().prev();$(["ct","jst","t","s"]).each(function(e){let o=t.attr(`data-${e}`);o&&n.find(`[data-${e}]`).html(o)}),n.find("[data-d]").html(i.find("span").html()),n.find("[data-ty]").html(i.attr("data-ty")),o.open()})}if(t.match(/\/jegyek/g)){e.closest("nr").addClass("open");let t=Modal($("#addModal"));$(".fab").on("click",t.open);let n=$("#tr"),o=$("#nn");$("#cnn").on("click",function(){if(o.is(".valid")){let e=$(`[data-v="${n.val()}"]`).parent().find("nd:not(:empty)"),i=$(e.slice(-3,-2)),a=$(e.slice(-1)),l=o.val(),d=$("#tz")[0].checked,s=d?"b":"span",c=d?2:1,r=e[e.length-4],h=$(r);r.innerHTML+=` <${s} tooltip='Milenne ha-val hozzáadott jegy&#xa;Súly: ${c}00%' class='milenne'>${l}</${s}> `,requestAnimationFrame(()=>{r.scrollIntoView()}),h.parent().addClass("open");let m=e.find("b, span").length,f=i.html(),p=[f*m,c*Number(l)],u=n[0].selectedOptions[0],g=Math.round(100*average(p,m+c))/100;i.html(g),u.innerHTML=u.innerHTML.replace(f,g);let v=Math.round(100*(g-$(e.slice(-2,-1)).html()))/100;a.html(v).removeClass("gr red").addClass(v<0?"red":"gr"),t.close()}else o[0].focus()})}$(window).on("mousemove","[tooltip]",function(){$(this).toggleClass("bot",$(this).offset().top-window.scrollY-window.getComputedStyle(this,":after").getPropertyValue("height").replace("px","")-76<=0)}),$(window).on("dblclick",".milenne",function(){$(this).remove()}),$("a[href*=logout]").on("click",function(){deleteCookie("naplo"),deleteCookie("rme")})}function addCookie(e,t=1){var n=new Date;n.setDate(n.getDate()+365),document.cookie=`${e}=${t};expires=${n.toUTCString()};path=/`}function deleteCookie(e){document.cookie=`${e}=;expires=Thu, 01 Jan 1970 00:00:00 UTC;path=/`}function os(){let e=$("#txt")[0],t=e.innerText;return t?($("#hw").val(t),!0):(e.focus(),!1)}"ic"in window&&$(()=>{ic.on(init),ic.init("mousedown");let e=$("#gdpr");if(e.length&&Modal(e,{opacity:0,dismissible:!1,preventScrolling:!1,onCloseEnd:function(){addCookie("gdpr")}}).open(),$(".pwa").length){let e;window.addEventListener("beforeinstallprompt",t=>{t.prevendefault(),e=t,$(".pwa").show().on("click",()=>{e.prompt(),e.userChoice.then(t=>{"accepted"===t.outcome?(addCookie("pwa",1),console.log("User accepted the A2HS prompt")):(addCookie("pwa",0),console.log("User dismissed the A2HS prompt")),e=null})})})}}),"serviceWorker"in navigator&&navigator.serviceWorker.register("./sw.js",{scope:"/"}).then(function(e){console.log("Service Worker Registered"),location.href.indexOf("login")<0&&e.sync.register("bg")});