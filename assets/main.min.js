function getf(e,t){xhr=new XMLHttpRequest,xhr.open("GET",e),xhr.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),xhr.onload=function(){200===xhr.status&&xhr.responseText&&t(xhr.responseText)},xhr.send()}function s(){if(location.href.match(/\/orarend/g)){window.mh=0,$(".collection-item").css("height","unset");for(let e=$("ul"),t=0;e.length;e=$("ul.collection li:nth-child("+ ++t+")")){if(0==t)continue;let n=0;e.each(e=>{n=Math.max($(e).height(),n)}),e.css("height",n+"px")}}}$(window).on("resize",s),location.href.match(/^(?=.*\/login)(?!.*(toldy|sch)).*/g)&&getf("schools",function(e){e=JSON.parse(e);let t=$("#sc"),n=t[0].list?$("#slc"):$("#rslc"),o=n.find("selected");o.length&&(o=o.val()),n.html(""),$(e).each(function(){n.append('<option value="'+this.v+'"'+(o==this.v?(o="","selected"):"")+">"+this.n+"</option>")}),t.on("blur",function(){if(!this.value)return;$("option[value="+this.value+"]").length?(this.setCustomValidity(""),M.validate_field($("#sc"))):this.setCustomValidity("Adjon meg egy érvényes értéket")})});const average=(e,t=e.length)=>e.reduce((e,t)=>e+t)/t;function init(){let e=$(location.hash);if(e.length&&requestAnimationFrame(()=>{e[0].scrollIntoView()}),location.href.match(/\/orarend/g)){s();var t=$("#modal"),n=Modal(t);$(".lesson").on("click",function(e){$("#modal span").html("-");let o=$(this),l=o.find("b");t.find(".modal-content>span").html(l.is(".em")?"Elmarad!":"");let i=o.find("i");$(["lecke","time","theme"]).each(function(e){let n=i.attr(`data-${e}`);n&&t.find(`[data-${e}]`).html(n)}),t.find("[data-nth]").html(o.parent().attr("data-nth")),t.find("[data-tr]").html(l.html()),t.find("[data-teacher]").html(i.html()),t.find("[data-room]").html(o.find(".secondary-content").html()),n.open()})}if(location.href.match(/\/lecke/g)){s();t=$("#modal"),n=Modal(t);var o=Modal($("#addModal"));$(".collection-item").on("click",function(e){$("#modal span").html("-");let o=$(this);$(["lecke","sender","cdate"]).each(function(e){let n=o.attr(`data-${e}`);n&&t.find(`[data-${e}]`).html(n)}),t.find("[data-deadline]").html(o.find("a").html()),t.find("[data-tr]").html(o[0].innerHTML.split("<")[0]);let l=t.find("a").css({display:"none"});o.hasAttr("data-del")&&l.css({display:"block"}).attr("href","../lecke/torles?did="+o.attr("data-del")),n.open()}),(new DatePicker).renderCalendar(),$(".fab").on("click",function(){o.open()})}if(Collapsible($(".collapsible")),location.href.match(/\/jegyek/g)){e.closest("ntr").addClass("open");let t=Modal($("#addModal"));$(".fab").on("click",t.open);let n=$("#tr");$("#cnn").on("click",function(){let e=$(`[data-v="${n.val()}"]`).parent().find("ntd:not(:empty)"),t=$(e.slice(-3,-2)),o=$(e.slice(-1)),l=$("#nn").val(),i=$("#tz")[0].checked,a=i?"b":"span",r=i?2:1;$(e[e.length-4])[0].innerHTML+=` <${a} tooltip='Milenna ha-val hozzáadott jegy&#xa;Súly: ${r}00%'>${l}</${a}> `;let d=e.find("b, span").length,s=t.html(),c=[s*d,r*Number(l)],h=n[0].selectedOptions[0],p=Math.round(100*average(c,d+r))/100;t.html(p),h.innerHTML=h.innerHTML.replace(s,p);let f=Math.round(100*(p-$(e.slice(-2,-1)).html()))/100;o.html(f).removeClass("gr red").addClass(f<0?"red":"gr")})}$("[tooltip]").on("mouseenter",function(){$(this).toggleClass("bot",$(this).offset().top-window.scrollY-window.getComputedStyle(this,":after").getPropertyValue("height").replace("px","")-20<=0)}),$("a[href*=logout]").on("click",function(){deleteCookie("naplo"),deleteCookie("rme")})}function addCookie(e,t=1){var n=new Date;n.setDate(n.getDate()+365),document.cookie=`${e}=${t};expires=${n.toUTCString()};path=/`}function deleteCookie(e){document.cookie=`${e}=;expires=Thu, 01 Jan 1970 00:00:00 UTC;path=/`}$.fn.ready(()=>{ic.on(init),ic.init("mousedown")});let g=$("#gdpr");g.length&&Modal(g,{opacity:0,dismissible:!1,preventScrolling:!1,onCloseEnd:function(){addCookie("gdpr")}}).open(),"serviceWorker"in navigator&&navigator.serviceWorker.register("./sw.js",{scope:"/"}).then(function(){return console.log("Service Worker Registered"),swRegistration.sync.register("bg")});let p=$("#pwa");if(p.length){let e;window.addEventListener("beforeinstallprompt",t=>{t.preventDefault(),e=t,Modal(p,{opacity:0,preventScrolling:!1}).open(),$("#pwa-btn").on("click",()=>{e.prompt(),e.userChoice.then(t=>{"accepted"===t.outcome?(addCookie("pwa"),console.log("User accepted the A2HS prompt")):console.log("User dismissed the A2HS prompt"),e=null})})})}function os(){let e=$("#txt")[0].innerText;return!!e&&($("#hw").val(e),!0)}